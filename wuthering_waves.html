<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Wuthering Waves Tracker</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
/* ===============================
   BASE
================================ */
*{ box-sizing:border-box; }

body{
  margin:0;
  font-family:system-ui;
  background:#0b1020;
  color:#ffffff;
}

/* ===============================
   CARD
================================ */
.card{
  background:#0f1730;
  border:1px solid #2b3357;
  border-radius:16px;
  padding:20px;
}

/* ===============================
   CHARACTER HEADER
================================ */
.char-header{
  display:flex;
  gap:20px;
}

/* IMAGE + ICONS = 1 BLOK */
.char-left{
  display:flex;
  flex-direction:column;
  align-items:center;
  min-width:320px;          /* ðŸ”¥ KRITISCH */
  flex-shrink:0;
}

.char-img{
  width:160px;
  height:160px;
  object-fit:cover;
  border-radius:12px;
  background:#1b2450;
}

/* ===============================
   RESONANCE ICONS (6 OP 1 RIJ)
================================ */
.chain-icons{
  display:flex !important;
  flex-wrap:nowrap !important;
  gap:10px;
  margin-top:12px;
  justify-content:center;
}

.chain-icon{
  width:44px;
  height:44px;
  background:#1b2450;
  border-radius:8px;
  opacity:.25;
  transition:.2s;
  flex:0 0 auto;            /* ðŸ”¥ GEEN WRAP */
}

.chain-icon.active{
  opacity:1;
  filter:drop-shadow(0 0 6px rgba(255,200,120,.6));
}

.chain-icon.clickable{
  cursor:pointer;
}

.chain-icon.clickable:hover{
  transform:scale(1.15);
  opacity:1;
}

.chain-icon.disabled{
  cursor:not-allowed;
  opacity:.15;
}

/* ===============================
   INFO
================================ */
.char-info{
  flex:1;
}

.pill{
  padding:4px 10px;
  border-radius:999px;
  border:1px solid #2b3357;
  font-size:.75rem;
  margin-left:6px;
}

/* ===============================
   SKILLS
================================ */
.skill-row{
  display:flex;
  justify-content:space-between;
  margin-bottom:6px;
}

input{
  background:#121a33!important;
  color:#ffffff!important;
  border:1px solid #2b3357!important;
  border-radius:6px;
  padding:4px 6px;
}
</style>
</head>

<body class="container py-4">

<h1 class="fw-bold">Wuthering Waves â€“ Character Tracker</h1>
<p>Resonance icons zijn alleen klikbaar als Owned is aangevinkt.</p>

<div id="list" class="row g-4"></div>

<script>
/* ===============================
   CONFIG
================================ */
const KEY = "ww_tracker_final";
const RESONANCE_BASE = "assets/wuwa/resonance";
const PLACEHOLDER = `${RESONANCE_BASE}/placeholder.jpg`;

/* ===============================
   CHARACTERS
================================ */
const CHARACTERS = [
  "augusta","brant","calcharo","camellya","cantarella","carlotta",
  "cartethyia","changli","chisa","ciaccona","encore","galbrena",
  "iuno","jianxin","jinhsi","jiyan","lingyang","lupa","lynae",
  "mornye","phoebe","phrolova","qiuyuan","roccia","shorekeeper",
  "verina","xiangli-yao","yinlin","zani","zhezhi"
].map(id => ({
  id,
  name: id.replace(/(^|-)\w/g, m => m.toUpperCase()),
  rarity:"5â˜…",
  image:`assets/wuwa/icons/${id}.jpg`
}));

/* ===============================
   STATE
================================ */
function defaultChar(){
  return {
    owned:false,
    level:1,
    chain:0,
    skills:{ basic:1, skill:1, forte:1, liberation:1, outro:1 }
  };
}

function load(){
  const s = localStorage.getItem(KEY);
  const d = s ? JSON.parse(s) : {};
  CHARACTERS.forEach(c=>{
    if(!d[c.id]) d[c.id] = defaultChar();
  });
  localStorage.setItem(KEY,JSON.stringify(d));
  return d;
}

function clamp(v,min,max){
  v = Number(v);
  return isNaN(v)?min:Math.max(min,Math.min(max,v));
}

/* ===============================
   HELPERS
================================ */
function iconPath(id,n){
  return `${RESONANCE_BASE}/${id}/${n}.jpg`;
}

function iconError(img){
  img.onerror=null;
  img.src=PLACEHOLDER;
}

/* ===============================
   RENDER
================================ */
function render(){
  const data = load();
  const list = document.getElementById("list");
  list.innerHTML="";

  CHARACTERS.forEach(c=>{
    const d = data[c.id];
    const owned = d.owned;

    const col = document.createElement("div");
    col.className="col-lg-6";

    col.innerHTML = `
      <div class="card">
        <div class="char-header">
          <div class="char-left">
            <img src="${c.image}" class="char-img">

            <div class="chain-icons">
              ${[1,2,3,4,5,6].map(n=>`
                <img
                  src="${iconPath(c.id,n)}"
                  class="chain-icon ${d.chain>=n?'active':''} ${owned?'clickable':'disabled'}"
                  ${owned?`onclick="setChain('${c.id}',${n})"`:''}
                  onerror="iconError(this)">
              `).join("")}
            </div>
          </div>

          <div class="char-info">
            <strong>${c.name}</strong>
            <span class="pill">${c.rarity}</span>

            <div class="mt-2">
              Level
              <input type="text" value="${d.level}"
                oninput="setVal('${c.id}','level',this.value,1,90)"
                style="width:70px">
            </div>

            <div class="form-check mt-2">
              <input class="form-check-input" type="checkbox"
                ${owned?"checked":""}
                onchange="setOwned('${c.id}',this.checked)">
              <label class="form-check-label">Owned</label>
            </div>
          </div>
        </div>

        <hr>

        ${Object.entries(d.skills).map(([k,v])=>`
          <div class="skill-row">
            <span>${k}</span>
            <input type="text" value="${v}"
              oninput="setSkill('${c.id}','${k}',this.value)"
              style="width:60px">
          </div>
        `).join("")}
      </div>
    `;
    list.appendChild(col);
  });
}

/* ===============================
   HANDLERS
================================ */
function setOwned(id,val){
  const d=load();
  d[id].owned=val;
  if(!val) d[id].chain=0;
  localStorage.setItem(KEY,JSON.stringify(d));
  render();
}

function setChain(id,val){
  const d=load();
  d[id].chain = d[id].chain===val ? 0 : val;
  localStorage.setItem(KEY,JSON.stringify(d));
  render();
}

function setVal(id,key,val,min,max){
  const d=load();
  d[id][key]=clamp(val,min,max);
  localStorage.setItem(KEY,JSON.stringify(d));
}

function setSkill(id,skill,val){
  const d=load();
  d[id].skills[skill]=clamp(val,1,10);
  localStorage.setItem(KEY,JSON.stringify(d));
}

render();
</script>

</body>
</html>
